---
title: "Week3"
author: "JamesDale"
date: "2/7/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
download.file("http://www.openintro.org/stat/data/bdims.RData", destfile = "bdims.RData")
load("bdims.RData")
```

## Quick Look
```{r quick-look}
head(bdims)
# Subset men and women
mdims <- subset(bdims, sex == 1)
fdims <- subset(bdims, sex == 0)
```

## Exercise 1
```{r ex1-1}
# Female mean and SD
fhgtmean <- mean(fdims$hgt)
fhgtsd   <- sd(fdims$hgt)
# Plot histogram
hist(fdims$hgt, probability = TRUE, ylim = c(0, 0.07))

# x Range 140-190, y generate random based on mean and SD
#x <- min(fdims$hgt) : max(fdims$hgt)
x <- 140:190
y <- dnorm(x = x, mean = fhgtmean, sd = fhgtsd)
lines(x = x, y = y, col = "blue")
```

## Exercise 2

```{r ex2-1}
# Q plot for “quantile-quantile”
qqnorm(fdims$hgt)
qqline(fdims$hgt)

# Create sample we know is normal generated by rnorm
sim_norm <- rnorm(n = length(fdims$hgt), mean = fhgtmean, sd = fhgtsd)

par(mfrow=c(1,2))
qqnorm(fdims$hgt, main = "FDIMS")
qqline(fdims$hgt)

qqnorm(sim_norm, main = "Normal Sample")
qqline(sim_norm)
```

## Exercisse 3

```{r ex3-1}
# Probability plot for sim_norm
qqnorm(sim_norm)
qqline(sim_norm)
```

After plotting the sim_norm distribution it appears not all the points fall on the line. A few points deviate in on the tails but overall the distribution seems pretty tight. The plots also seem tighter in the middle of the sample norm vs fdims$hgt.

```{r ex3-2}
qqnormsim(fdims$hgt)
```

## Exercise 4

Based on the probaility plot female weight seems to have a normal distribution however with some skewness represented below by the short tails at the beginning and end of the plot.
```{r ex4-1}
qqnorm(sim_norm) 
qqline(sim_norm)
```

## Exercise 5
```{r ex5-1}
# Female mean and SD
fwgtmean <- mean(fdims$wgt)
fwgtsd   <- sd(fdims$wgt)
# Plot histogram
hist(fdims$wgt, probability = TRUE)
     

# x Range , y generate random based on mean and SD
x <- min(fdims$wgt) : max(fdims$wgt)

y <- dnorm(x = x, mean = fhgtmean, sd = fhgtsd)
lines(x = x, y = y, col = "blue")

# Q plot for “quantile-quantile”
qqnorm(fdims$wgt)
qqline(fdims$wgt)

# Create sample we know is normal generated by rnorm
sim_norm_wgt <- rnorm(n = length(fdims$wgt), mean = fwgtmean, sd = fwgtsd)

par(mfrow=c(1,2))
qqnorm(fdims$wgt, main = "FDIMS")
qqline(fdims$wgt)

qqnorm(sim_norm_wgt, main = "Normal Sample")
qqline(sim_norm_wgt)
```

Imediatley we can see from the histogram that the female weight data is not normally distributed. From the histogram we see the distribution shows a right skew supported by the QQ plots which show a long tail. 

## Exercise 6
```{r ex6-1}
# Calc z score
1 - pnorm(q = 182, mean = fhgtmean, sd = fhgtsd)
# Percent of observations fall above 182 
sum(fdims$hgt > 182) / length(fdims$hgt)
```


### What is the probability that a randomly chosen female is under 5'4"
#### The theoretical probability is __`r pnorm(q = 162, mean = fhgtmean, sd = fhgtsd)`__ while the probability empirically is __`r sum(fdims$hgt < 162) / length(fdims$hgt)`__.

### What is the probability that a randomly chosen female will weight more than 77 kilograms
#### The theoretical probability is __`r 1 - pnorm(q = 77, mean = fwgtmean, sd = fwgtsd)`__ while the probability empirically is __`r sum(fdims$wgt > 77) / length(fdims$wgt)`__.


## Activity 1
__a.__ The histogram for female biiliac (pelvic) diameter (bii.di) belongs to normal probability plot letter __B__.

__b.__ The histogram for female elbow diameter (elb.di) belongs to normal probability plot letter __C__.

__c.__ The histogram for general age (age) belongs to normal probability plot letter __D__.

__d.__ The histogram for female chest depth (che.de) belongs to normal probability plot letter __A__.

## Activity 2
The plots c and d most likely show a slight stepwise pattern because given the c is showing the distribution for age and d is showing the distribution for chest depth, the fact that these a discrete dimensions would cause the stepwise pattern. 

## Activity 3
```{r act3-1}
knee_mean <- mean(fdims$kne.di)
knee_sd   <- sd(fdims$kne.di)
# Plot histogram
hist(fdims$kne.di, probability = TRUE)

knee_x <- min(fdims$kne.di) : max(fdims$kne.di)
knee_y <- dnorm(x = knee_x, mean = knee_mean, sd = knee_sd)
lines(x = knee_x, y = knee_y, col = "blue")
```

#### Based on the findings from the histogram above I would say the distribution is right skewed. 